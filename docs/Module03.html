
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rearranging Data with {tidyr} &#8212; Data Analytics with R (MPA 5830)</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://aniruhil.github.io/jb530-repo/index.html/docs/Module03.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Managing dates and Times with {lubridate}" href="Module04.html" />
    <link rel="prev" title="Cleaning Data with {dplyr}" href="Module02.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo5830.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Analytics with R (MPA 5830)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro.html">
   Introduction to MPA 5830
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reading Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module01.html">
   Reading data in R
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Cleaning &amp; Organizng Data
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module02.html">
   Cleaning Data with {dplyr}
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Rearranging Data with {tidyr}
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Module04.html">
   Managing dates and Times with {lubridate}
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Visualizing Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module05.html">
   Visualizing Data with {ggplot2}
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Module06.html">
   Advanced Data Visualization
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/Module03.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/aniruhil/jb5830-repo"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/aniruhil/jb5830-repo/issues/new?title=Issue%20on%20page%20%2Fdocs/Module03.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/aniruhil/jb5830-repo/main?urlpath=tree/docs/docs/Module03.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Rearranging Data with {tidyr}
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tidyr">
     {tidyr}
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#separate">
       separate()
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#unite">
       unite()
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pivoting-data">
     Pivoting data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#wide-to-long-with-pivot-longer">
       Wide-to-Long with pivot_longer()
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#long-to-wide-with-pivot-wider">
       Long-to-wide with pivot_wider()
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-example-that-follows-is-a-tricky-one-so-be-careful">
       The example that follows is a tricky one so be careful!!
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises-for-practice">
   Exercises for Practice
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-01">
     Exercise 01
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-02">
     Exercise 02
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-03">
     Exercise 03
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Rearranging Data with {tidyr}</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Rearranging Data with {tidyr}
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tidyr">
     {tidyr}
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#separate">
       separate()
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#unite">
       unite()
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pivoting-data">
     Pivoting data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#wide-to-long-with-pivot-longer">
       Wide-to-Long with pivot_longer()
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#long-to-wide-with-pivot-wider">
       Long-to-wide with pivot_wider()
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-example-that-follows-is-a-tricky-one-so-be-careful">
       The example that follows is a tricky one so be careful!!
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises-for-practice">
   Exercises for Practice
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-01">
     Exercise 01
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-02">
     Exercise 02
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-03">
     Exercise 03
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="rearranging-data-with-tidyr">
<h1>Rearranging Data with {tidyr}<a class="headerlink" href="#rearranging-data-with-tidyr" title="Permalink to this headline">¶</a></h1>
<div class="section" id="tidyr">
<h2>{tidyr}<a class="headerlink" href="#tidyr" title="Permalink to this headline">¶</a></h2>
<p>In the previous week we learned how to clean and prepare data with several {dplyr} functions – <code class="docutils literal notranslate"><span class="pre">select()</span></code>, <code class="docutils literal notranslate"><span class="pre">filter()</span></code>, <code class="docutils literal notranslate"><span class="pre">summarise()</span></code>, <code class="docutils literal notranslate"><span class="pre">mutate()</span></code>, <code class="docutils literal notranslate"><span class="pre">group_by()</span></code>, <code class="docutils literal notranslate"><span class="pre">case_when()</span></code>, and so on. In this module we will tackle other challenging problems and lean on another package, <code class="docutils literal notranslate"><span class="pre">{tidyr}</span></code> to do so.</p>
<p>This library seems to have only four core functions, <code class="docutils literal notranslate"><span class="pre">separate</span></code>, <code class="docutils literal notranslate"><span class="pre">unite()</span></code>, <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code>, and <code class="docutils literal notranslate"><span class="pre">pivot_wider()</span></code> but each of them packs a wallop.</p>
<div class="section" id="separate">
<h3>separate()<a class="headerlink" href="#separate" title="Permalink to this headline">¶</a></h3>
<p>You will, at times, end up with columns that contain multiple pieces of information, all mashed up into some alphanumeric string or sequence of numbers. <code class="docutils literal notranslate"><span class="pre">separate()</span></code> allows us to split this mashed up column into specific pieces. For example, here are some data from the Census Bureau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>

<span class="nf">read_csv</span><span class="p">(</span>
  <span class="s">&quot;https://www2.census.gov/programs-surveys/popest/datasets/2010-2018/metro/totals/cbsa-est2018-alldata.csv&quot;</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cbsa</span>

<span class="n">cbsa</span> <span class="o">%&gt;%</span>
  <span class="nf">select</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">glimpse</span><span class="p">()</span>
  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Attaching packages</span> ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.1 ──
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">ggplot2</span> 3.3.5     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">purrr  </span> 0.3.4
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">tibble </span> 3.1.6     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">dplyr  </span> 1.0.7
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">tidyr  </span> 1.1.4     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">stringr</span> 1.4.0
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">readr  </span> 2.1.1     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">forcats</span> 0.5.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Conflicts</span> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">filter()</span> masks <span class=" -Color -Color-Blue">stats</span>::filter()
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">lag()</span>    masks <span class=" -Color -Color-Blue">stats</span>::lag()
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">2789</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">88</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">──</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Red">chr</span>  (3): STCOU, NAME, LSAD
<span class=" -Color -Color-Green">dbl</span> (85): CBSA, MDIV, CENSUS2010POP, ESTIMATESBASE2010, POPESTIMATE2010, POP...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">ℹ</span> Use <span class=" -Color -Color-Black -Color-Black-BGWhite">`spec()`</span> to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">ℹ</span> Specify the column types or set <span class=" -Color -Color-Black -Color-Black-BGWhite">`show_col_types = FALSE`</span> to quiet this message.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rows: 2,789
Columns: 1
$ NAME &lt;chr&gt; &quot;Abilene, TX&quot;, &quot;Callahan County, TX&quot;, &quot;Jones County, TX&quot;, &quot;Taylor…
</pre></div>
</div>
</div>
</div>
<p>This data-set contains population estimates for CBSAs – core-based statistical areas. What are these?</p>
<blockquote>
<div><p>Metropolitan and Micropolitan Statistical Areas are collectively referred to as Core-Based Statistical Areas.
Metropolitan statistical areas have at least one urbanized area of 50,000 or more population, plus adjacent territory that has a high degree of social and economic integration with the core as measured by commuting ties.
Micropolitan statistical areas are a new set of statistical areas that have at least one urban cluster of at least 10,000 but less than 50,000 population, plus adjacent territory that has a high degree of social and economic integration with the core as measured by commuting ties.
Metropolitan and micropolitan statistical areas are defined in terms of whole counties or county equivalents, including the six New England states. As of June 6, 2003, there are 362 metropolitan statistical areas and 560 micropolitan statistical areas in the United States. <a class="reference external" href="https://www.census.gov/topics/housing/housing-patterns/about/core-based-statistical-areas.html">Source</a></p>
</div></blockquote>
<p>Look at the column called <code class="docutils literal notranslate"><span class="pre">NAME</span></code> and note how It combines the state’s name (abbreviated) and the name of the area, “Abilene, TX”, “Callahan County, TX”, “Jones County, TX”, and so on.</p>
<p>This is a common issue with many census data-sets and so it would be nice to be able to split up this <code class="docutils literal notranslate"><span class="pre">NAME</span></code> column into two pieces</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(1) `placename` (&quot;Abilene&quot;, &quot;Callahan County&quot;, etc) and 
(2) `stateabb` (&quot;TX&quot;, &quot;TX&quot;, etc.) 
</pre></div>
</div>
<p>We do this below, with the separation occurring where a <code class="docutils literal notranslate"><span class="pre">&quot;,&quot;</span></code> is seen in <code class="docutils literal notranslate"><span class="pre">NAME</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cbsa</span> <span class="o">%&gt;%</span>
  <span class="nf">separate</span><span class="p">(</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">NAME</span><span class="p">,</span> 
    <span class="n">into</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;placename&quot;</span><span class="p">,</span> <span class="s">&quot;stateabb&quot;</span><span class="p">),</span>
    <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;, &quot;</span><span class="p">,</span>
    <span class="n">remove</span> <span class="o">=</span> <span class="kc">FALSE</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cbsa</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in gregexpr(pattern, x, perl = TRUE):
“PCRE error
	&#39;UTF-8 error: byte 2 top bits not 0x80&#39;
	for element 800”
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in gregexpr(pattern, x, perl = TRUE):
“PCRE error
	&#39;UTF-8 error: byte 2 top bits not 0x80&#39;
	for element 1767”
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in gregexpr(pattern, x, perl = TRUE):
“PCRE error
	&#39;UTF-8 error: byte 2 top bits not 0x80&#39;
	for element 1931”
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Expected 2 pieces. Missing pieces filled with `NA` in 3 rows [800, 1767, 1931].”
</pre></div>
</div>
</div>
</div>
<p>Let us see the original column and the two new columns we created.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cbsa</span> <span class="o">%&gt;%</span>
  <span class="nf">select</span><span class="p">(</span><span class="n">NAME</span><span class="p">,</span> <span class="n">placename</span><span class="p">,</span> <span class="n">stateabb</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 3</caption>
<thead>
	<tr><th scope=col>NAME</th><th scope=col>placename</th><th scope=col>stateabb</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Abilene, TX        </td><td>Abilene        </td><td>TX</td></tr>
	<tr><td>Callahan County, TX</td><td>Callahan County</td><td>TX</td></tr>
	<tr><td>Jones County, TX   </td><td>Jones County   </td><td>TX</td></tr>
	<tr><td>Taylor County, TX  </td><td>Taylor County  </td><td>TX</td></tr>
	<tr><td>Akron, OH          </td><td>Akron          </td><td>OH</td></tr>
	<tr><td>Portage County, OH </td><td>Portage County </td><td>OH</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cbsa</span> <span class="o">%&gt;%</span>
    <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 90</caption>
<thead>
	<tr><th scope=col>CBSA</th><th scope=col>MDIV</th><th scope=col>STCOU</th><th scope=col>NAME</th><th scope=col>placename</th><th scope=col>stateabb</th><th scope=col>LSAD</th><th scope=col>CENSUS2010POP</th><th scope=col>ESTIMATESBASE2010</th><th scope=col>POPESTIMATE2010</th><th scope=col>⋯</th><th scope=col>NETMIG2018</th><th scope=col>RESIDUAL2010</th><th scope=col>RESIDUAL2011</th><th scope=col>RESIDUAL2012</th><th scope=col>RESIDUAL2013</th><th scope=col>RESIDUAL2014</th><th scope=col>RESIDUAL2015</th><th scope=col>RESIDUAL2016</th><th scope=col>RESIDUAL2017</th><th scope=col>RESIDUAL2018</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>⋯</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>10180</td><td>NA</td><td>NA   </td><td>Abilene, TX        </td><td>Abilene        </td><td>TX</td><td>Metropolitan Statistical Area</td><td>165252</td><td>165246</td><td>165583</td><td>⋯</td><td>301</td><td> -5</td><td>-15</td><td> -8</td><td> 19</td><td> -19</td><td>-16</td><td> -4</td><td> -5</td><td> -8</td></tr>
	<tr><td>10180</td><td>NA</td><td>48059</td><td>Callahan County, TX</td><td>Callahan County</td><td>TX</td><td>County or equivalent         </td><td> 13544</td><td> 13546</td><td> 13513</td><td>⋯</td><td> 50</td><td> -1</td><td> -1</td><td> -2</td><td> -2</td><td>  -1</td><td> -1</td><td>  0</td><td>  0</td><td>  0</td></tr>
	<tr><td>10180</td><td>NA</td><td>48253</td><td>Jones County, TX   </td><td>Jones County   </td><td>TX</td><td>County or equivalent         </td><td> 20202</td><td> 20192</td><td> 20237</td><td>⋯</td><td>-25</td><td>  1</td><td>  3</td><td> 12</td><td>  3</td><td>   2</td><td>  3</td><td> -1</td><td>  0</td><td> -2</td></tr>
	<tr><td>10180</td><td>NA</td><td>48441</td><td>Taylor County, TX  </td><td>Taylor County  </td><td>TX</td><td>County or equivalent         </td><td>131506</td><td>131508</td><td>131833</td><td>⋯</td><td>276</td><td> -5</td><td>-17</td><td>-18</td><td> 18</td><td> -20</td><td>-18</td><td> -3</td><td> -5</td><td> -6</td></tr>
	<tr><td>10420</td><td>NA</td><td>NA   </td><td>Akron, OH          </td><td>Akron          </td><td>OH</td><td>Metropolitan Statistical Area</td><td>703200</td><td>703203</td><td>703035</td><td>⋯</td><td>522</td><td>-33</td><td>-43</td><td>-39</td><td>-73</td><td>-105</td><td>-52</td><td>-15</td><td>-26</td><td>-27</td></tr>
	<tr><td>10420</td><td>NA</td><td>39133</td><td>Portage County, OH </td><td>Portage County </td><td>OH</td><td>County or equivalent         </td><td>161419</td><td>161425</td><td>161389</td><td>⋯</td><td>371</td><td> -5</td><td>-18</td><td>  2</td><td>-10</td><td> -28</td><td>-10</td><td>  0</td><td> -1</td><td> -5</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Here is what each piece of code is doing:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>code</p></th>
<th class="text-align:left head"><p>what it does …</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>col =</p></td>
<td class="text-align:left"><p>identifies the column to be separated</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>into =</p></td>
<td class="text-align:left"><p>creates the names for the new columns that will result</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>sep =</p></td>
<td class="text-align:left"><p>indicates where the separation should occur</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>remove =</p></td>
<td class="text-align:left"><p>indicates whether the column to be separated should be removed from the data-set or retained once the new columns have been created. Setting it equal to <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> will keep the original column, <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> will remove it.</p></td>
</tr>
</tbody>
</table>
<p>What if the column to be separated was made up of numbers rather than text? Take the <code class="docutils literal notranslate"><span class="pre">STCOU</span></code> column, for instance. Look like numbers, right? Except these numbers are really identifiers, FIPS codes to be exact, with the first two digits flagging what state this area is in and the next three digits identifying the area itself. Ohio’s FIPS code is, for instance, <code class="docutils literal notranslate"><span class="pre">39</span></code>, and Portage County’s FIPS code is <code class="docutils literal notranslate"><span class="pre">133</span></code>. So here, it would be nice to create two new columns, one with the state FIPS code (<code class="docutils literal notranslate"><span class="pre">stfips</span></code>) and the second with the county FIPS code (<code class="docutils literal notranslate"><span class="pre">coufips</span></code>). We do this below, but this time setting <code class="docutils literal notranslate"><span class="pre">sep</span> <span class="pre">=</span> <span class="pre">2</span></code> because we want the separation to happen after the second digit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cbsa</span> <span class="o">%&gt;%</span>
  <span class="nf">separate</span><span class="p">(</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">STCOU</span><span class="p">,</span> 
    <span class="n">into</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;stfips&quot;</span><span class="p">,</span> <span class="s">&quot;coufips&quot;</span><span class="p">),</span>
    <span class="n">sep</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
    <span class="n">remove</span> <span class="o">=</span> <span class="kc">FALSE</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cbsa</span>

<span class="n">cbsa</span> <span class="o">%&gt;%</span>
  <span class="nf">select</span><span class="p">(</span><span class="n">STCOU</span><span class="p">,</span> <span class="n">stfips</span><span class="p">,</span> <span class="n">coufips</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 3</caption>
<thead>
	<tr><th scope=col>STCOU</th><th scope=col>stfips</th><th scope=col>coufips</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>NA   </td><td>NA</td><td>NA </td></tr>
	<tr><td>48059</td><td>48</td><td>059</td></tr>
	<tr><td>48253</td><td>48</td><td>253</td></tr>
	<tr><td>48441</td><td>48</td><td>441</td></tr>
	<tr><td>NA   </td><td>NA</td><td>NA </td></tr>
	<tr><td>39133</td><td>39</td><td>133</td></tr>
</tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="unite">
<h3>unite()<a class="headerlink" href="#unite" title="Permalink to this headline">¶</a></h3>
<p>This is the very opposite of <code class="docutils literal notranslate"><span class="pre">separate()</span></code> – two or more columns are united into ONE column. For example, take the file I am reading in as <code class="docutils literal notranslate"><span class="pre">coudf</span></code>. This file has similar content to what we read in for the CBSAs but this one has data for counties and states.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">read_csv</span><span class="p">(</span>
  <span class="s">&quot;https://www2.census.gov/programs-surveys/popest/datasets/2010-2018/counties/totals/co-est2018-alldata.csv&quot;</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">coudf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">3193</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">148</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">──</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Red">chr</span>   (5): SUMLEV, STATE, COUNTY, STNAME, CTYNAME
<span class=" -Color -Color-Green">dbl</span> (143): REGION, DIVISION, CENSUS2010POP, ESTIMATESBASE2010, POPESTIMATE20...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">ℹ</span> Use <span class=" -Color -Color-Black -Color-Black-BGWhite">`spec()`</span> to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">ℹ</span> Specify the column types or set <span class=" -Color -Color-Black -Color-Black-BGWhite">`show_col_types = FALSE`</span> to quiet this message.
</pre></div>
</div>
</div>
</div>
<p>Let us filter this file so that we retain rows only for counties. I am doing this with <code class="docutils literal notranslate"><span class="pre">filter(COUNTY</span> <span class="pre">!=</span> <span class="pre">&quot;000&quot;)</span></code> because the state rows are the ones with <code class="docutils literal notranslate"><span class="pre">COUNTY</span> <span class="pre">==</span> <span class="pre">&quot;000&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">coudf</span> <span class="o">%&gt;%</span>
  <span class="nf">filter</span><span class="p">(</span><span class="n">COUNTY</span> <span class="o">!=</span> <span class="s">&quot;000&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">coudf2</span>

<span class="n">coudf2</span> <span class="o">%&gt;%</span>
  <span class="nf">select</span><span class="p">(</span><span class="n">STNAME</span><span class="p">,</span> <span class="n">CTYNAME</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 2</caption>
<thead>
	<tr><th scope=col>STNAME</th><th scope=col>CTYNAME</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Alabama</td><td>Autauga County</td></tr>
	<tr><td>Alabama</td><td>Baldwin County</td></tr>
	<tr><td>Alabama</td><td>Barbour County</td></tr>
	<tr><td>Alabama</td><td>Bibb County   </td></tr>
	<tr><td>Alabama</td><td>Blount County </td></tr>
	<tr><td>Alabama</td><td>Bullock County</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Now I want to combine the county name (<code class="docutils literal notranslate"><span class="pre">CTYNAME</span></code>) and the state name (<code class="docutils literal notranslate"><span class="pre">STNAME</span></code>) into a single column, with the two names separated by a comma and a single white-space, i.e., by <code class="docutils literal notranslate"><span class="pre">&quot;,</span> <span class="pre">&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">coudf2</span> <span class="o">%&gt;%</span>
  <span class="nf">unite</span><span class="p">(</span>
    <span class="n">col</span> <span class="o">=</span> <span class="s">&quot;countystate&quot;</span><span class="p">,</span>
    <span class="nf">c</span><span class="p">(</span><span class="s">&quot;CTYNAME&quot;</span><span class="p">,</span> <span class="s">&quot;STNAME&quot;</span><span class="p">),</span>
    <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;, &quot;</span><span class="p">,</span>
    <span class="n">remove</span> <span class="o">=</span> <span class="kc">FALSE</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">coudf2</span>

<span class="n">coudf2</span> <span class="o">%&gt;%</span>
  <span class="nf">select</span><span class="p">(</span><span class="n">CTYNAME</span><span class="p">,</span> <span class="n">STNAME</span><span class="p">,</span> <span class="n">countystate</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 3</caption>
<thead>
	<tr><th scope=col>CTYNAME</th><th scope=col>STNAME</th><th scope=col>countystate</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Autauga County</td><td>Alabama</td><td>Autauga County, Alabama</td></tr>
	<tr><td>Baldwin County</td><td>Alabama</td><td>Baldwin County, Alabama</td></tr>
	<tr><td>Barbour County</td><td>Alabama</td><td>Barbour County, Alabama</td></tr>
	<tr><td>Bibb County   </td><td>Alabama</td><td>Bibb County, Alabama   </td></tr>
	<tr><td>Blount County </td><td>Alabama</td><td>Blount County, Alabama </td></tr>
	<tr><td>Bullock County</td><td>Alabama</td><td>Bullock County, Alabama</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Key elements here, are,</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>code</p></th>
<th class="text-align:left head"><p>what it does …</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>col =</p></td>
<td class="text-align:left"><p>identifies the <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">column</span></code> to be created</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>c(“…”)</p></td>
<td class="text-align:left"><p>identifies the columns to be combined, as in c(“column1”, “column2”, “column3”)</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>sep =</p></td>
<td class="text-align:left"><p>indicates if we want the merged elements to be separated in some manner. Here we are using “, ” to separate with a comma followed by a single white-space. But we could have used any separator or no separator at all</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>remove =</p></td>
<td class="text-align:left"><p>indicates if we want the original columns deleted <code class="docutils literal notranslate"><span class="pre">(TRUE)</span></code> or not <code class="docutils literal notranslate"><span class="pre">(FALSE)</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="pivoting-data">
<h2>Pivoting data<a class="headerlink" href="#pivoting-data" title="Permalink to this headline">¶</a></h2>
<p>If I look at the original CBSA file <code class="docutils literal notranslate"><span class="pre">cbsa</span></code>, I see that it has been setup very oddly. In particular, starting with column 6 we have a jumble of information …</p>
<ul class="simple">
<li><p>CENSUS2010POP, ESTIMATESBASE2010, POPESTIMATE2010 all have the population totals for 2010.</p></li>
<li><p>POPESTIMATE2011 through POPESTIMATE2018 are the population totals for 2011-2018</p></li>
<li><p>NPOPCHG_20XY give us net population change for 2010-2018</p></li>
<li><p>BIRTHS20XY give us the number of births for 2010-2018</p></li>
<li><p>DEATHS20XY give us the number of deaths for 2010-2018</p></li>
<li><p>NATURALINC20XY gives us the natural increase = births - deaths for 2010-2018</p></li>
<li><p>INTERNATIONALMIG20XY gives us international immigrant totals for for 2010-2018</p></li>
<li><p>DOMESTICMIG20XY gives us domestic migrant totals for 2010-2018</p></li>
<li><p>NETMIG20XY give us net migration totals for 2010-2018</p></li>
<li><p>RESIDUAL20XY gives us some small numbers left over after adding and subtracting the</p></li>
</ul>
<p>Let us keep only a few columns (columns 4, and then 8 through 16) to see what the current layout looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">read_csv</span><span class="p">(</span>
  <span class="s">&quot;https://www2.census.gov/programs-surveys/popest/datasets/2010-2018/metro/totals/cbsa-est2018-alldata.csv&quot;</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cbsa</span>

<span class="n">cbsa</span> <span class="o">%&gt;%</span>
  <span class="nf">select</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">8</span><span class="o">:</span><span class="m">16</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">cbsa01</span>

<span class="n">cbsa01</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">2789</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">88</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">──</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Red">chr</span>  (3): STCOU, NAME, LSAD
<span class=" -Color -Color-Green">dbl</span> (85): CBSA, MDIV, CENSUS2010POP, ESTIMATESBASE2010, POPESTIMATE2010, POP...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">ℹ</span> Use <span class=" -Color -Color-Black -Color-Black-BGWhite">`spec()`</span> to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">ℹ</span> Specify the column types or set <span class=" -Color -Color-Black -Color-Black-BGWhite">`show_col_types = FALSE`</span> to quiet this message.
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 10</caption>
<thead>
	<tr><th scope=col>NAME</th><th scope=col>POPESTIMATE2010</th><th scope=col>POPESTIMATE2011</th><th scope=col>POPESTIMATE2012</th><th scope=col>POPESTIMATE2013</th><th scope=col>POPESTIMATE2014</th><th scope=col>POPESTIMATE2015</th><th scope=col>POPESTIMATE2016</th><th scope=col>POPESTIMATE2017</th><th scope=col>POPESTIMATE2018</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Abilene, TX        </td><td>165583</td><td>166616</td><td>167447</td><td>167472</td><td>168355</td><td>169704</td><td>170018</td><td>170516</td><td>171451</td></tr>
	<tr><td>Callahan County, TX</td><td> 13513</td><td> 13511</td><td> 13488</td><td> 13501</td><td> 13506</td><td> 13591</td><td> 13789</td><td> 13968</td><td> 13994</td></tr>
	<tr><td>Jones County, TX   </td><td> 20237</td><td> 20266</td><td> 19870</td><td> 20034</td><td> 19846</td><td> 19972</td><td> 19969</td><td> 19852</td><td> 19817</td></tr>
	<tr><td>Taylor County, TX  </td><td>131833</td><td>132839</td><td>134089</td><td>133937</td><td>135003</td><td>136141</td><td>136260</td><td>136696</td><td>137640</td></tr>
	<tr><td>Akron, OH          </td><td>703035</td><td>703123</td><td>702080</td><td>703625</td><td>704921</td><td>704448</td><td>703690</td><td>704367</td><td>704845</td></tr>
	<tr><td>Portage County, OH </td><td>161389</td><td>161857</td><td>161375</td><td>161691</td><td>162459</td><td>162615</td><td>162595</td><td>162625</td><td>162927</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="section" id="wide-to-long-with-pivot-longer">
<h3>Wide-to-Long with pivot_longer()<a class="headerlink" href="#wide-to-long-with-pivot-longer" title="Permalink to this headline">¶</a></h3>
<p>Why did they not setup the data in such a way that it had the following <code class="docutils literal notranslate"><span class="pre">tidy</span></code> structure? This would make a lot more sense rather than having each year be a column all its own.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>NAME</p></th>
<th class="text-align:left head"><p>YEAR</p></th>
<th class="text-align:left head"><p>POPULATION</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>Abilene, TX</p></td>
<td class="text-align:left"><p>2010</p></td>
<td class="text-align:left"><p>165583</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Abilene, TX</p></td>
<td class="text-align:left"><p>2011</p></td>
<td class="text-align:left"><p>166616</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Abilene, TX</p></td>
<td class="text-align:left"><p>2012</p></td>
<td class="text-align:left"><p>167447</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>…</p></td>
<td class="text-align:left"><p>…</p></td>
<td class="text-align:left"><p>…</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Callahan County, TX</p></td>
<td class="text-align:left"><p>2010</p></td>
<td class="text-align:left"><p>13513</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Callahan County, TX</p></td>
<td class="text-align:left"><p>2011</p></td>
<td class="text-align:left"><p>13511</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Callahan County, TX</p></td>
<td class="text-align:left"><p>2012</p></td>
<td class="text-align:left"><p>13488</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>…</p></td>
<td class="text-align:left"><p>…</p></td>
<td class="text-align:left"><p>…</p></td>
</tr>
</tbody>
</table>
<p>Well, we can easily create the proper structure of the data-set, as shown below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cbsa01</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">pivot_longer</span><span class="p">(</span>
    <span class="n">names_to</span> <span class="o">=</span> <span class="s">&quot;variable&quot;</span><span class="p">,</span>
    <span class="n">values_to</span> <span class="o">=</span> <span class="s">&quot;POPULATION&quot;</span><span class="p">,</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="m">2</span><span class="o">:</span><span class="m">10</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cbsa01.long</span>

<span class="n">cbsa01.long</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A grouped_df: 6 × 3</caption>
<thead>
	<tr><th scope=col>NAME</th><th scope=col>variable</th><th scope=col>POPULATION</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Abilene, TX</td><td>POPESTIMATE2010</td><td>165583</td></tr>
	<tr><td>Abilene, TX</td><td>POPESTIMATE2011</td><td>166616</td></tr>
	<tr><td>Abilene, TX</td><td>POPESTIMATE2012</td><td>167447</td></tr>
	<tr><td>Abilene, TX</td><td>POPESTIMATE2013</td><td>167472</td></tr>
	<tr><td>Abilene, TX</td><td>POPESTIMATE2014</td><td>168355</td></tr>
	<tr><td>Abilene, TX</td><td>POPESTIMATE2015</td><td>169704</td></tr>
</tbody>
</table>
</div></div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>code</p></th>
<th class="text-align:left head"><p>what it does …</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>names_to =</p></td>
<td class="text-align:left"><p>identifies the name of the new column that will be created</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>values_to =</p></td>
<td class="text-align:left"><p>identifies the name of the new column in which values will be stored</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>cols =</p></td>
<td class="text-align:left"><p>identifies the columns that will be pivoted from wide to long</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>group_by() =</p></td>
<td class="text-align:left"><p>holds unique combinations of whatever column names you put in <code class="docutils literal notranslate"><span class="pre">group_by()</span></code> fixed while it pivots the other columns</p></td>
</tr>
</tbody>
</table>
<p>I still need to clean up the variable column so that it only shows the four-digit year rather than POPESTIMATE2010, and so on. Let us do this next.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cbsa01.long</span> <span class="o">%&gt;%</span>
  <span class="nf">separate</span><span class="p">(</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">variable</span><span class="p">,</span>
    <span class="n">into</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;todiscard&quot;</span><span class="p">,</span> <span class="s">&quot;toyear&quot;</span><span class="p">),</span>
    <span class="n">sep</span> <span class="o">=</span> <span class="m">11</span><span class="p">,</span>
    <span class="n">remove</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cbsa01.long2</span>

<span class="n">cbsa01.long2</span> <span class="o">%&gt;%</span>
  <span class="nf">mutate</span><span class="p">(</span><span class="n">YEAR</span> <span class="o">=</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">toyear</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="nf">select</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">NAME</span><span class="p">,</span> <span class="n">YEAR</span><span class="p">,</span> <span class="n">POPULATION</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">cbsa01.long3</span>

<span class="n">cbsa01.long3</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A grouped_df: 6 × 3</caption>
<thead>
	<tr><th scope=col>NAME</th><th scope=col>YEAR</th><th scope=col>POPULATION</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Abilene, TX</td><td>2010</td><td>165583</td></tr>
	<tr><td>Abilene, TX</td><td>2011</td><td>166616</td></tr>
	<tr><td>Abilene, TX</td><td>2012</td><td>167447</td></tr>
	<tr><td>Abilene, TX</td><td>2013</td><td>167472</td></tr>
	<tr><td>Abilene, TX</td><td>2014</td><td>168355</td></tr>
	<tr><td>Abilene, TX</td><td>2015</td><td>169704</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Another way to do this would have been with the <code class="docutils literal notranslate"><span class="pre">stringr</span></code> package, something we will see a little of down the road. Here, we use a specific function (<em>str_remove_all</em>) from <code class="docutils literal notranslate"><span class="pre">stringr</span></code> to eliminate the “POPESTIMATE” string more efficiently.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cbsa01.long</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span>
    <span class="n">Year</span> <span class="o">=</span> <span class="n">stringr</span><span class="o">::</span><span class="nf">str_remove_all</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="s">&quot;POPESTIMATE&quot;</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cbsa.long4</span>

<span class="n">cbsa.long4</span> <span class="o">%&gt;%</span>
    <span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="n">variable</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A grouped_df: 6 × 3</caption>
<thead>
	<tr><th scope=col>NAME</th><th scope=col>POPULATION</th><th scope=col>Year</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Abilene, TX</td><td>165583</td><td>2010</td></tr>
	<tr><td>Abilene, TX</td><td>166616</td><td>2011</td></tr>
	<tr><td>Abilene, TX</td><td>167447</td><td>2012</td></tr>
	<tr><td>Abilene, TX</td><td>167472</td><td>2013</td></tr>
	<tr><td>Abilene, TX</td><td>168355</td><td>2014</td></tr>
	<tr><td>Abilene, TX</td><td>169704</td><td>2015</td></tr>
</tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="long-to-wide-with-pivot-wider">
<h3>Long-to-wide with pivot_wider()<a class="headerlink" href="#long-to-wide-with-pivot-wider" title="Permalink to this headline">¶</a></h3>
<p>Now, let us say the data-set was a different one, perhaps the one shown below. This data-set comes from the 2017 American Community Survey and along with state FIPS codes (<code class="docutils literal notranslate"><span class="pre">geoid</span></code>) and state name (<code class="docutils literal notranslate"><span class="pre">NAME</span></code>) it contains data on <code class="docutils literal notranslate"><span class="pre">income</span></code> = median yearly income, <code class="docutils literal notranslate"><span class="pre">rent</span></code> = median monthly rent, and <code class="docutils literal notranslate"><span class="pre">moe</span></code> = the margin of error at the 90% confidence level.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">us_rent_income</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 5</caption>
<thead>
	<tr><th scope=col>GEOID</th><th scope=col>NAME</th><th scope=col>variable</th><th scope=col>estimate</th><th scope=col>moe</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>01</td><td>Alabama</td><td>income</td><td>24476</td><td>136</td></tr>
	<tr><td>01</td><td>Alabama</td><td>rent  </td><td>  747</td><td>  3</td></tr>
	<tr><td>02</td><td>Alaska </td><td>income</td><td>32940</td><td>508</td></tr>
	<tr><td>02</td><td>Alaska </td><td>rent  </td><td> 1200</td><td> 13</td></tr>
	<tr><td>04</td><td>Arizona</td><td>income</td><td>27517</td><td>148</td></tr>
	<tr><td>04</td><td>Arizona</td><td>rent  </td><td>  972</td><td>  4</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Notice here the setup looks weird because two different variables (<em>income</em> and <em>rent</em>) have been combined in a single column. In addition, the estimate and the moe (the margin of error) for both income and rent is also squeezed into single columns respectively.</p>
<p>Instead, the data-set should have been <code class="docutils literal notranslate"><span class="pre">tidyly</span></code> setup as follows:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>GEOID</p></th>
<th class="text-align:left head"><p>NAME</p></th>
<th class="text-align:right head"><p>income</p></th>
<th class="text-align:right head"><p>rent</p></th>
<th class="text-align:right head"><p>moe_income</p></th>
<th class="text-align:right head"><p>moe_rent</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>01</p></td>
<td class="text-align:left"><p>Alabama</p></td>
<td class="text-align:right"><p>24476</p></td>
<td class="text-align:right"><p>747</p></td>
<td class="text-align:right"><p>136</p></td>
<td class="text-align:right"><p>3</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>02</p></td>
<td class="text-align:left"><p>Alaska</p></td>
<td class="text-align:right"><p>32940</p></td>
<td class="text-align:right"><p>1200</p></td>
<td class="text-align:right"><p>508</p></td>
<td class="text-align:right"><p>13</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>03</p></td>
<td class="text-align:left"><p>Arizona</p></td>
<td class="text-align:right"><p>27517</p></td>
<td class="text-align:right"><p>972</p></td>
<td class="text-align:right"><p>148</p></td>
<td class="text-align:right"><p>4</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>…</p></td>
<td class="text-align:left"><p>…</p></td>
<td class="text-align:right"><p>…</p></td>
<td class="text-align:right"><p>…</p></td>
<td class="text-align:right"><p>…</p></td>
<td class="text-align:right"><p>…</p></td>
</tr>
</tbody>
</table>
<p>Well, this can be done as well, with the <code class="docutils literal notranslate"><span class="pre">pivot_wider()</span></code> function that takes from the “long” format to the “wide” format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">us_rent_income</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">GEOID</span><span class="p">,</span> <span class="n">NAME</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">pivot_wider</span><span class="p">(</span>
    <span class="n">names_from</span> <span class="o">=</span> <span class="n">variable</span><span class="p">,</span>
    <span class="n">values_from</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">estimate</span><span class="p">,</span> <span class="n">moe</span><span class="p">)</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">usri.wide</span>

<span class="n">usri.wide</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A grouped_df: 6 × 6</caption>
<thead>
	<tr><th scope=col>GEOID</th><th scope=col>NAME</th><th scope=col>estimate_income</th><th scope=col>estimate_rent</th><th scope=col>moe_income</th><th scope=col>moe_rent</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>01</td><td>Alabama   </td><td>24476</td><td> 747</td><td>136</td><td> 3</td></tr>
	<tr><td>02</td><td>Alaska    </td><td>32940</td><td>1200</td><td>508</td><td>13</td></tr>
	<tr><td>04</td><td>Arizona   </td><td>27517</td><td> 972</td><td>148</td><td> 4</td></tr>
	<tr><td>05</td><td>Arkansas  </td><td>23789</td><td> 709</td><td>165</td><td> 5</td></tr>
	<tr><td>06</td><td>California</td><td>29454</td><td>1358</td><td>109</td><td> 3</td></tr>
	<tr><td>08</td><td>Colorado  </td><td>32401</td><td>1125</td><td>109</td><td> 5</td></tr>
</tbody>
</table>
</div></div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>code</p></th>
<th class="text-align:left head"><p>what it does …</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>names_from =</p></td>
<td class="text-align:left"><p>identifies the column from which unique values will be taken to create the names of the new columns that will result</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>values_from =</p></td>
<td class="text-align:left"><p>identifies the column(s) from which the values should be assigned to the new columns that will result</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>group_by()</p></td>
<td class="text-align:left"><p>holds unique value combinations of whatever column names you put in <code class="docutils literal notranslate"><span class="pre">group_by()</span></code> fixed while it pivots the rows to new columns</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-example-that-follows-is-a-tricky-one-so-be-careful">
<h3>The example that follows is a tricky one so be careful!!<a class="headerlink" href="#the-example-that-follows-is-a-tricky-one-so-be-careful" title="Permalink to this headline">¶</a></h3>
<p>Here is another example, this time with the <code class="docutils literal notranslate"><span class="pre">cbsa</span></code> data but showing you how we might use a combination of <code class="docutils literal notranslate"><span class="pre">pivot_longer()</span></code> and <code class="docutils literal notranslate"><span class="pre">pivot_wider()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cbsa</span> <span class="o">%&gt;%</span>
  <span class="nf">select</span><span class="p">(</span><span class="m">3</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> <span class="m">8</span><span class="o">:</span><span class="m">88</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">pivot_longer</span><span class="p">(</span>
    <span class="n">names_to</span> <span class="o">=</span> <span class="s">&quot;variable&quot;</span><span class="p">,</span>
    <span class="n">values_to</span> <span class="o">=</span> <span class="s">&quot;estimate&quot;</span><span class="p">,</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="m">4</span><span class="o">:</span><span class="m">84</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cbsa.01</span>

<span class="n">cbsa.01</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">(</span><span class="n">.</span><span class="p">,</span> <span class="m">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A grouped_df: 20 × 5</caption>
<thead>
	<tr><th scope=col>STCOU</th><th scope=col>NAME</th><th scope=col>LSAD</th><th scope=col>variable</th><th scope=col>estimate</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2010</td><td>165583</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2011</td><td>166616</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2012</td><td>167447</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2013</td><td>167472</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2014</td><td>168355</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2015</td><td>169704</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2016</td><td>170018</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2017</td><td>170516</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2018</td><td>171451</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>NPOPCHG2010    </td><td>   337</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>NPOPCHG2011    </td><td>  1033</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>NPOPCHG2012    </td><td>   831</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>NPOPCHG2013    </td><td>    25</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>NPOPCHG2014    </td><td>   883</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>NPOPCHG2015    </td><td>  1349</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>NPOPCHG2016    </td><td>   314</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>NPOPCHG2017    </td><td>   498</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>NPOPCHG2018    </td><td>   935</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>BIRTHS2010     </td><td>   540</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>BIRTHS2011     </td><td>  2295</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Now I will clean up the contents of cbsa.01 so that year is a separate column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cbsa.01</span> <span class="o">%&gt;%</span>
  <span class="nf">separate</span><span class="p">(</span>
    <span class="n">col</span> <span class="o">=</span> <span class="s">&quot;variable&quot;</span><span class="p">,</span>
    <span class="n">into</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;vartype&quot;</span><span class="p">,</span> <span class="s">&quot;year&quot;</span><span class="p">),</span>
    <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;(?=[[:digit:]])&quot;</span><span class="p">,</span>
    <span class="n">extra</span> <span class="o">=</span> <span class="s">&quot;merge&quot;</span><span class="p">,</span>
    <span class="n">remove</span> <span class="o">=</span> <span class="kc">FALSE</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cbsa.02</span>

<span class="n">cbsa.02</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A grouped_df: 6 × 7</caption>
<thead>
	<tr><th scope=col>STCOU</th><th scope=col>NAME</th><th scope=col>LSAD</th><th scope=col>variable</th><th scope=col>vartype</th><th scope=col>year</th><th scope=col>estimate</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2010</td><td>POPESTIMATE</td><td>2010</td><td>165583</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2011</td><td>POPESTIMATE</td><td>2011</td><td>166616</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2012</td><td>POPESTIMATE</td><td>2012</td><td>167447</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2013</td><td>POPESTIMATE</td><td>2013</td><td>167472</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2014</td><td>POPESTIMATE</td><td>2014</td><td>168355</td></tr>
	<tr><td>NA</td><td>Abilene, TX</td><td>Metropolitan Statistical Area</td><td>POPESTIMATE2015</td><td>POPESTIMATE</td><td>2015</td><td>169704</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Here, notice that the <code class="docutils literal notranslate"><span class="pre">sep</span> <span class="pre">=</span> </code> command looks different. What is this specification here? Well, if you look at the column names we need to flip in <strong>cbsa</strong>, you will notice that the four-digit year does not always start at the same place. Here are the column names …</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">names</span><span class="p">(</span><span class="n">cbsa</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'CBSA'</li><li>'MDIV'</li><li>'STCOU'</li><li>'NAME'</li><li>'LSAD'</li><li>'CENSUS2010POP'</li><li>'ESTIMATESBASE2010'</li><li>'POPESTIMATE2010'</li><li>'POPESTIMATE2011'</li><li>'POPESTIMATE2012'</li><li>'POPESTIMATE2013'</li><li>'POPESTIMATE2014'</li><li>'POPESTIMATE2015'</li><li>'POPESTIMATE2016'</li><li>'POPESTIMATE2017'</li><li>'POPESTIMATE2018'</li><li>'NPOPCHG2010'</li><li>'NPOPCHG2011'</li><li>'NPOPCHG2012'</li><li>'NPOPCHG2013'</li><li>'NPOPCHG2014'</li><li>'NPOPCHG2015'</li><li>'NPOPCHG2016'</li><li>'NPOPCHG2017'</li><li>'NPOPCHG2018'</li><li>'BIRTHS2010'</li><li>'BIRTHS2011'</li><li>'BIRTHS2012'</li><li>'BIRTHS2013'</li><li>'BIRTHS2014'</li><li>'BIRTHS2015'</li><li>'BIRTHS2016'</li><li>'BIRTHS2017'</li><li>'BIRTHS2018'</li><li>'DEATHS2010'</li><li>'DEATHS2011'</li><li>'DEATHS2012'</li><li>'DEATHS2013'</li><li>'DEATHS2014'</li><li>'DEATHS2015'</li><li>'DEATHS2016'</li><li>'DEATHS2017'</li><li>'DEATHS2018'</li><li>'NATURALINC2010'</li><li>'NATURALINC2011'</li><li>'NATURALINC2012'</li><li>'NATURALINC2013'</li><li>'NATURALINC2014'</li><li>'NATURALINC2015'</li><li>'NATURALINC2016'</li><li>'NATURALINC2017'</li><li>'NATURALINC2018'</li><li>'INTERNATIONALMIG2010'</li><li>'INTERNATIONALMIG2011'</li><li>'INTERNATIONALMIG2012'</li><li>'INTERNATIONALMIG2013'</li><li>'INTERNATIONALMIG2014'</li><li>'INTERNATIONALMIG2015'</li><li>'INTERNATIONALMIG2016'</li><li>'INTERNATIONALMIG2017'</li><li>'INTERNATIONALMIG2018'</li><li>'DOMESTICMIG2010'</li><li>'DOMESTICMIG2011'</li><li>'DOMESTICMIG2012'</li><li>'DOMESTICMIG2013'</li><li>'DOMESTICMIG2014'</li><li>'DOMESTICMIG2015'</li><li>'DOMESTICMIG2016'</li><li>'DOMESTICMIG2017'</li><li>'DOMESTICMIG2018'</li><li>'NETMIG2010'</li><li>'NETMIG2011'</li><li>'NETMIG2012'</li><li>'NETMIG2013'</li><li>'NETMIG2014'</li><li>'NETMIG2015'</li><li>'NETMIG2016'</li><li>'NETMIG2017'</li><li>'NETMIG2018'</li><li>'RESIDUAL2010'</li><li>'RESIDUAL2011'</li><li>'RESIDUAL2012'</li><li>'RESIDUAL2013'</li><li>'RESIDUAL2014'</li><li>'RESIDUAL2015'</li><li>'RESIDUAL2016'</li><li>'RESIDUAL2017'</li><li>'RESIDUAL2018'</li></ol>
</div></div>
</div>
<p>Notice POPESTIMATE, NPOPCHG, BIRTHS, DEATHS, and so on.</p>
<p>What we need therefore is to specify where the solumns should be separated, and we do that by saying separate wherever you see the first nuymeric digit appear. This is our <code class="docutils literal notranslate"><span class="pre">sep</span> <span class="pre">=</span> <span class="pre">&quot;(?=[[:digit:]])&quot;</span></code> command.</p>
<p>Now the final flip to wide format, by first omitting the first, third, and four columns, then grouping by NAME and year, and then pivoting wide …</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cbsa.02</span> <span class="o">%&gt;%</span>
  <span class="nf">select</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">5</span><span class="o">:</span><span class="m">7</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">NAME</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">pivot_wider</span><span class="p">(</span>
    <span class="n">names_from</span> <span class="o">=</span> <span class="s">&quot;vartype&quot;</span><span class="p">,</span>
    <span class="n">values_from</span> <span class="o">=</span> <span class="s">&quot;estimate&quot;</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cbsa.03</span>

<span class="n">cbsa.03</span> <span class="o">%&gt;%</span>
  <span class="nf">glimpse</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Values are not uniquely identified; output will contain list-cols.
* Use `values_fn = list` to suppress this warning.
* Use `values_fn = length` to identify where the duplicates arise
* Use `values_fn = {summary_fun}` to summarise duplicates”
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rows: 25,083
Columns: 11
Groups: NAME, year [25,083]
$ NAME             &lt;chr&gt; &quot;Abilene, TX&quot;, &quot;Abilene, TX&quot;, &quot;Abilene, TX&quot;, &quot;Abilene…
$ year             &lt;chr&gt; &quot;2010&quot;, &quot;2011&quot;, &quot;2012&quot;, &quot;2013&quot;, &quot;2014&quot;, &quot;2015&quot;, &quot;2016…
$ POPESTIMATE      &lt;list&gt; 165583, 166616, 167447, 167472, 168355, 169704, 1700…
$ NPOPCHG          &lt;list&gt; 337, 1033, 831, 25, 883, 1349, 314, 498, 935, -33, -…
$ BIRTHS           &lt;list&gt; 540, 2295, 2358, 2390, 2382, 2417, 2379, 2427, 2381,…
$ DEATHS           &lt;list&gt; 406, 1506, 1587, 1694, 1598, 1698, 1726, 1705, 1739,…
$ NATURALINC       &lt;list&gt; 134, 789, 771, 696, 784, 719, 653, 722, 642, -29, -3…
$ INTERNATIONALMIG &lt;list&gt; 84, 205, 516, 361, 419, 484, 388, 325, 282, 0, 4, 5,…
$ DOMESTICMIG      &lt;list&gt; 124, 54, -448, -1051, -301, 162, -723, -544, 19, -3,…
$ NETMIG           &lt;list&gt; 208, 259, 68, -690, 118, 646, -335, -219, 301, -3, 3…
$ RESIDUAL         &lt;list&gt; -5, -15, -8, 19, -19, -16, -4, -5, -8, -1, -1, -2, -…
</pre></div>
</div>
</div>
</div>
<p>And there you have it. We are just getting familiar with the heart of <code class="docutils literal notranslate"><span class="pre">dplyr</span></code> and <code class="docutils literal notranslate"><span class="pre">tidyr</span></code>, both written to work well together, and an essential part of any data analysts’ toolkit.</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="exercises-for-practice">
<h1>Exercises for Practice<a class="headerlink" href="#exercises-for-practice" title="Permalink to this headline">¶</a></h1>
<div class="section" id="exercise-01">
<h2>Exercise 01<a class="headerlink" href="#exercise-01" title="Permalink to this headline">¶</a></h2>
<p>Using the <code class="docutils literal notranslate"><span class="pre">cmhflights</span></code> data from last week, create a column that unites the three columns <code class="docutils literal notranslate"><span class="pre">Year</span></code>, <code class="docutils literal notranslate"><span class="pre">Month</span></code>, and <code class="docutils literal notranslate"><span class="pre">DayofMonth</span></code> into a single column that we will name <code class="docutils literal notranslate"><span class="pre">date_of_flight</span></code>. This column should separate the three fields by “-” so that dates appear as <code class="docutils literal notranslate"><span class="pre">2017-1-9</span></code> and so on.</p>
</div>
<div class="section" id="exercise-02">
<h2>Exercise 02<a class="headerlink" href="#exercise-02" title="Permalink to this headline">¶</a></h2>
<p>Sticking with <code class="docutils literal notranslate"><span class="pre">cmhflights</span></code>, separate <code class="docutils literal notranslate"><span class="pre">OriginCityName</span></code> into two new columns, <code class="docutils literal notranslate"><span class="pre">origin_city</span></code> and <code class="docutils literal notranslate"><span class="pre">origin_state</span></code>. Do the same for <code class="docutils literal notranslate"><span class="pre">DestCityName</span></code>, calling the new columns <code class="docutils literal notranslate"><span class="pre">destination_city</span></code> and <code class="docutils literal notranslate"><span class="pre">destination_state</span></code>, respectively. Both city columns should only display the name of the city, while both state columns should only display the abbreviated state name (for example, “CA”, “OH”, etc.)</p>
</div>
<div class="section" id="exercise-03">
<h2>Exercise 03<a class="headerlink" href="#exercise-03" title="Permalink to this headline">¶</a></h2>
<p>Tidy the <code class="docutils literal notranslate"><span class="pre">weather</span></code> data such that the resulting data-set, called <code class="docutils literal notranslate"><span class="pre">wdf</span></code>, has the <code class="docutils literal notranslate"><span class="pre">days</span></code> (the d1-d31 columns) as rows and <code class="docutils literal notranslate"><span class="pre">TMIN</span></code> and <code class="docutils literal notranslate"><span class="pre">TMAX</span></code> as columns.</p>
<p>The data can be accessed as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">read.delim</span><span class="p">(</span>
 <span class="n">file</span> <span class="o">=</span> <span class="s">&quot;http://stat405.had.co.nz/data/weather.txt&quot;</span><span class="p">,</span>
 <span class="n">stringsAsFactors</span> <span class="o">=</span> <span class="kc">FALSE</span>
 <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">weather</span>

<span class="n">weather</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 22 × 35</caption>
<thead>
	<tr><th scope=col>id</th><th scope=col>year</th><th scope=col>month</th><th scope=col>element</th><th scope=col>d1</th><th scope=col>d2</th><th scope=col>d3</th><th scope=col>d4</th><th scope=col>d5</th><th scope=col>d6</th><th scope=col>⋯</th><th scope=col>d22</th><th scope=col>d23</th><th scope=col>d24</th><th scope=col>d25</th><th scope=col>d26</th><th scope=col>d27</th><th scope=col>d28</th><th scope=col>d29</th><th scope=col>d30</th><th scope=col>d31</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>⋯</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td>MX000017004</td><td>2010</td><td> 1</td><td>TMAX</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>278</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 1</td><td>TMIN</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>145</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 2</td><td>TMAX</td><td> NA</td><td>273</td><td>241</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td>299</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 2</td><td>TMIN</td><td> NA</td><td>144</td><td>144</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td>107</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 3</td><td>TMAX</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>321</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 3</td><td>TMIN</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>142</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 4</td><td>TMAX</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td>363</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 4</td><td>TMIN</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td>167</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 5</td><td>TMAX</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td>332</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 5</td><td>TMIN</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td>182</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 6</td><td>TMAX</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>301</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 6</td><td>TMIN</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>180</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 7</td><td>TMAX</td><td> NA</td><td> NA</td><td>286</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 7</td><td>TMIN</td><td> NA</td><td> NA</td><td>175</td><td> NA</td><td> NA</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 8</td><td>TMAX</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>296</td><td> NA</td><td>⋯</td><td>NA</td><td>264</td><td>NA</td><td>297</td><td> NA</td><td> NA</td><td> NA</td><td>280</td><td> NA</td><td>254</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td> 8</td><td>TMIN</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>158</td><td> NA</td><td>⋯</td><td>NA</td><td>150</td><td>NA</td><td>156</td><td> NA</td><td> NA</td><td> NA</td><td>153</td><td> NA</td><td>154</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td>10</td><td>TMAX</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>270</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td>312</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td>10</td><td>TMIN</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>140</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td>150</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td>11</td><td>TMAX</td><td> NA</td><td>313</td><td> NA</td><td>272</td><td>263</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td>281</td><td>277</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td>11</td><td>TMIN</td><td> NA</td><td>163</td><td> NA</td><td>120</td><td> 79</td><td> NA</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td>121</td><td>142</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td>12</td><td>TMAX</td><td>299</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>278</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
	<tr><td>MX000017004</td><td>2010</td><td>12</td><td>TMIN</td><td>138</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td>105</td><td>⋯</td><td>NA</td><td> NA</td><td>NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td><td> NA</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>The end result should be as shown below:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>id</p></th>
<th class="text-align:left head"><p>date</p></th>
<th class="text-align:left head"><p>TMIN</p></th>
<th class="text-align:left head"><p>TMAX</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>MX000017004</p></td>
<td class="text-align:left"><p>2010-1-1</p></td>
<td class="text-align:left"><p>NA</p></td>
<td class="text-align:left"><p>NA</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>MX000017004</p></td>
<td class="text-align:left"><p>2010-1-2</p></td>
<td class="text-align:left"><p>NA</p></td>
<td class="text-align:left"><p>NA</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>MX000017004</p></td>
<td class="text-align:left"><p>2010-1-3</p></td>
<td class="text-align:left"><p>NA</p></td>
<td class="text-align:left"><p>NA</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>MX000017004</p></td>
<td class="text-align:left"><p>2010-1-4</p></td>
<td class="text-align:left"><p>NA</p></td>
<td class="text-align:left"><p>NA</p></td>
</tr>
</tbody>
</table>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "aniruhil/jb5830-repo",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
            
                



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="Module02.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Cleaning Data with {dplyr}</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="Module04.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Managing dates and Times with {lubridate}</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Ani Ruhil<br/>
    
        &copy; Copyright 2022.<br/>
      <div class="extra_footer">
        Fall 2021
      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>